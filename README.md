# ðŸ›¡ï¸ Quantum-Secure Hybrid Communication System

### é‡å­å®‰å…¨æ··åˆåŠ å¯†é€šè¨Šç³»çµ± (Hybrid KEM + AES-GCM)

> **å°ˆæ¡ˆæ ¸å¿ƒç›®æ¨™**ï¼šå¯¦ä½œä¸€å€‹æŠ—é‡å­é›»è…¦æ”»æ“Šçš„æ··åˆå¯†é‘°å°è£æ©Ÿåˆ¶ (Hybrid KEM)ï¼Œçµåˆå‚³çµ±æ©¢åœ“æ›²ç·š (ECC) èˆ‡å¾Œé‡å­å¯†ç¢¼å­¸ (PQC) çš„å„ªå‹¢ï¼Œå»ºç«‹å…·å‚™å‰å‘ä¿å¯†æ€§ (PFS) èˆ‡å®Œæ•´æ€§é©—è­‰ (Integrity) çš„å®‰å…¨é€šè¨Šé€šé“ã€‚

---

## ðŸ— å°ˆæ¡ˆæž¶æ§‹èˆ‡è¨­è¨ˆç†å¿µ

æœ¬ç³»çµ±æŽ¡ç”¨ **Client-Server æž¶æ§‹**ï¼Œæ ¸å¿ƒé‚è¼¯èˆ‡ä»‹é¢åˆ†é›¢ï¼Œç¢ºä¿ç³»çµ±çš„å¯ç¶­è­·æ€§èˆ‡æ“´å……æ€§ã€‚

### æ ¸å¿ƒæ¨¡çµ„å±¤ç´š

1. **Core Kernel (`innovative_hybrid_kem.py`)**ï¼š
* ç³»çµ±çš„ã€Œå¤§è…¦ã€ã€‚å°è£äº†æ‰€æœ‰çš„å¯†ç¢¼å­¸åŽŸèªž (Primitives)ã€‚
* ç„¡ç‹€æ…‹è¨­è¨ˆ (Stateless)ï¼Œåƒ…è² è²¬è¼¸å…¥æ•¸æ“š -> è¼¸å‡ºåŠ å¯†çµæžœã€‚
* åŒ…å«ï¼šECC é‡‘é‘°ç”Ÿæˆã€PQC æ¨¡æ“¬å°è£ã€å¤šå±¤ KDF è¡ç”Ÿã€AES-GCM åŠ è§£å¯†ã€‚


2. **Controller Layer (`server.py`, `client.py`)**ï¼š
* è² è²¬ç¶²è·¯ Socket é€£ç·šç®¡ç†ã€å°åŒ…æ”¶ç™¼ã€ä»¥åŠ Session ID çš„ç‹€æ…‹åŒæ­¥ã€‚


3. **Presentation Layer (`gui_server.py`, `gui_client.py`)**ï¼š
* è¦–è¦ºåŒ–ä»‹é¢ã€‚
* Server ç«¯ï¼šé§­å®¢é¢¨æ ¼ç›£æŽ§å„€è¡¨æ¿ï¼Œå³æ™‚é¡¯ç¤ºæ””æˆªåˆ°çš„ IVã€Tag èˆ‡å¯†æ–‡ã€‚
* Client ç«¯ï¼šä½¿ç”¨è€…èŠå¤©è¦–çª—ï¼Œæä¾›ä¸€éµæ¡æ‰‹èˆ‡åŠ å¯†ç™¼é€åŠŸèƒ½ã€‚

---

## ðŸ›  æ ¸å¿ƒæŠ€è¡“å †ç–Š

| çµ„ä»¶ | æŠ€è¡“é¸æ“‡ | ç”¨é€”èˆ‡è¨­è¨ˆç†ç”± |
| --- | --- | --- |
| **PQC (å¾Œé‡å­)** | **Kyber-768 (Simulated)** | æ¨¡æ“¬ NIST æ¨™æº–åŒ–ä¹‹æ™¶æ ¼å¯†ç¢¼å­¸ï¼ŒæŠµæŠ—é‡å­é›»è…¦æ”»æ“Šã€‚(æœ¬å°ˆæ¡ˆç‚ºé‚è¼¯é©—è­‰ï¼Œæš«ä»¥é«˜ç†µéš¨æ©Ÿæ•¸æ¨¡æ“¬) |
| **ECC (å‚³çµ±)** | **X25519 (Curve25519)** | ä½¿ç”¨ `cryptography` åº«ã€‚æä¾›é«˜æ•ˆçš„å¯†é‘°äº¤æ›ï¼Œä½œç‚º PQC çš„ä¿éšª (Hybrid ç­–ç•¥)ã€‚ |
| **KDF (é‡‘é‘°è¡ç”Ÿ)** | **HKDF-SHA3** | ä½¿ç”¨ SHA3-512 èˆ‡ HMAC å»ºæ§‹å¤šå±¤è¡ç”Ÿå‡½æ•¸ï¼Œç¢ºä¿é‡‘é‘°çš„éš¨æ©Ÿæ€§èˆ‡æŠ—ç¢°æ’žæ€§ã€‚ |
| **åŠ å¯†å‚³è¼¸** | **AES-256-GCM** | è»è¦ç´šå°ç¨±åŠ å¯†ã€‚GCM æ¨¡å¼åŒæ™‚æä¾›**æ©Ÿå¯†æ€§ (Confidentiality)** èˆ‡ **å®Œæ•´æ€§ (Integrity)**ï¼Œé˜²æ­¢ä¸­é–“äººç¯¡æ”¹å°åŒ…ã€‚ |
| **é€šè¨Šå”å®š** | **TCP Socket** | è‡ªå®šç¾©æ‡‰ç”¨å±¤å”å®šï¼ŒåŒ…å« Header (é•·åº¦) èˆ‡ Payload (JSON/Binary)ã€‚ |

---

## ðŸ”„ ç³»çµ±æµç¨‹åœ–

### 1. æ··åˆå¯†é‘°æ¡æ‰‹ (Handshake Protocol)

```mermaid
sequenceDiagram
    participant C as Client
    participant S as Server
    
    Note over C: 1. ç”Ÿæˆ ECC è‡¨æ™‚é‡‘é‘°å°
    Note over C: 2. ç”Ÿæˆ PQC Secret & å°è£å¯†æ–‡
    C->>S: å‚³é€æ¡æ‰‹åŒ… (Salt + Time + PQC Ciphertext + Client ECC Pub)
    
    Note over S: 3. è§£æžå°åŒ…
    Note over S: 4. åŒæ­¥ Session ID
    Note over S: 5. PQC è§£å°è£ (å–å¾— Shared Secret)
    Note over S: 6. åŸ·è¡Œ X25519 äº¤æ› (å–å¾— ECC Secret)
    Note over S: 7. å¤šå±¤ KDF è¡ç”Ÿ Session Key
    
    S-->>C: å›žå‚³ Server ECC Public Key
    
    Note over C: 8. æ”¶åˆ° Server ECC Pub
    Note over C: 9. åŸ·è¡Œ X25519 äº¤æ›
    Note over C: 10. KDF è¡ç”Ÿ (åƒæ•¸èˆ‡ Server ä¸€è‡´)
    
    Note over C,S: é›™æ–¹ Session Key è‹¥ä¸€è‡´ï¼Œæ¡æ‰‹æˆåŠŸ

```

### 2. å®‰å…¨è¨Šæ¯å‚³è¼¸ (Secure Messaging)

1. **Client åŠ å¯†**ï¼š
* ç”Ÿæˆ 12 bytes éš¨æ©Ÿ `IV`ã€‚
* ä½¿ç”¨ `Session Key` åŸ·è¡Œ `AES-GCM` åŠ å¯† -> ç”¢å‡º `Ciphertext` èˆ‡ `Tag`ã€‚
* å°åŒ…å…§å®¹ï¼š`{ "iv": hex, "ciphertext": hex, "tag": hex }`ã€‚


2. **Server è§£å¯†**ï¼š
* æå– `IV` èˆ‡ `Tag`ã€‚
* åŸ·è¡Œ `AES-GCM` è§£å¯†ä¸¦é©—è­‰ Tagã€‚
* è‹¥ Tag é©—è­‰å¤±æ•— (ä»£è¡¨è¢«ç¯¡æ”¹)ï¼Œæ‹’çµ•è§£å¯†ï¼›æˆåŠŸå‰‡é¡¯ç¤ºæ˜Žæ–‡ã€‚



---

## ðŸš€ å®‰è£èˆ‡åŸ·è¡Œ

### ç’°å¢ƒéœ€æ±‚

* Python 3.10+
* å¿…è¦çš„ Python å¥—ä»¶ï¼š
```bash
pip install cryptography

```



### å•Ÿå‹•æ­¥é©Ÿ

1. **å•Ÿå‹•ç›£æŽ§ä¼ºæœå™¨**ï¼š
é–‹å•Ÿçµ‚ç«¯æ©Ÿï¼ŒåŸ·è¡Œï¼š
```bash
python network/gui_server.py

```


*ç­‰å¾… "ç›£è½ 127.0.0.1:8888" è¨Šæ¯å‡ºç¾ã€‚*
2. **å•Ÿå‹•ç”¨æˆ¶ç«¯**ï¼š
é–‹å•Ÿç¬¬äºŒå€‹çµ‚ç«¯æ©Ÿï¼ŒåŸ·è¡Œï¼š
```bash
python network/gui_client.py

```


3. **åŸ·è¡Œæ¡æ‰‹**ï¼š
* é»žæ“Š Client ä»‹é¢çš„ **"1. åŸ·è¡Œæ··åˆé‡‘é‘°æ¡æ‰‹"**ã€‚
* è§€å¯Ÿ Server ä»‹é¢é¡¯ç¤ºæ¡æ‰‹æˆåŠŸï¼Œä¸¦æ¯”å°é›™æ–¹é»ƒè‰²å­—é«”çš„ `Session Key` å‰ 16 ç¢¼æ˜¯å¦ä¸€è‡´ã€‚


4. **ç™¼é€åŠ å¯†è¨Šæ¯**ï¼š
* è¼¸å…¥è¨Šæ¯ä¸¦é»žæ“Š **"2. åŠ å¯†ä¸¦ç™¼é€"**ã€‚
* Server ä»‹é¢å°‡é¡¯ç¤ºæ””æˆªåˆ°çš„å¯†æ–‡ï¼Œä¸¦è‡ªå‹•è§£å¯†å‡ºåŽŸå§‹è¨Šæ¯ã€‚



---

## ðŸ§  æŠ€è¡“ç´°ç¯€èˆ‡å·¥ç¨‹æ±ºç­– (Engineering Decisions)

### Q1: ç‚ºä»€éº¼è¦ä½¿ç”¨ã€Œæ··åˆ (Hybrid)ã€åŠ å¯†ï¼Ÿ

å–®ç´”ä½¿ç”¨ PQC æ¼”ç®—æ³• (å¦‚ Kyber) é›–ç„¶æŠ—é‡å­ï¼Œä½†åœ¨å‚³çµ±é›»è…¦ä¸Šçš„å¯¦ä½œæ­·å²è¼ƒçŸ­ï¼Œå¯èƒ½æ½›è—æœªè¢«ç™¼ç¾çš„æ•¸å­¸æ¼æ´žã€‚çµåˆæˆç†Ÿçš„ ECC (X25519) å¯ä»¥ç¢ºä¿**ã€Œå³ä½¿ PQC è¢«æ”»ç ´ï¼Œå‚³çµ±å®‰å…¨æ€§ä¾ç„¶å­˜åœ¨ã€**çš„ç¸±æ·±é˜²ç¦¦æ•ˆæžœã€‚

### Q2: ç‚ºä»€éº¼é¸æ“‡ AES-GCM è€Œä¸æ˜¯ CBCï¼Ÿ

AES-CBC æ¨¡å¼å®¹æ˜“å—åˆ° Padding Oracle æ”»æ“Šï¼Œä¸”ä¸å…·å‚™å…§å»ºçš„å®Œæ•´æ€§é©—è­‰ã€‚GCM (Galois/Counter Mode) æ˜¯ä¸€ç¨® **AEAD (Authenticated Encryption with Associated Data)** æ¨¡å¼ï¼Œå®ƒåœ¨åŠ å¯†çš„åŒæ™‚ç”Ÿæˆ Authentication Tagã€‚å¦‚æžœä¸­é–“äººä¿®æ”¹äº†å¯†æ–‡çš„ä¸€å€‹ä½å…ƒï¼ŒTag é©—è­‰å°±æœƒå¤±æ•—ï¼Œç³»çµ±æœƒç›´æŽ¥ä¸Ÿæ£„å°åŒ…ï¼Œå¾žè€Œé˜²æ­¢å¯†æ–‡ç¯¡æ”¹æ”»æ“Šã€‚

### Q3: Session ID èˆ‡ Salt çš„ä½œç”¨ï¼Ÿ

ç‚ºäº†é˜²æ­¢**é‡æ”¾æ”»æ“Š (Replay Attack)** èˆ‡**å½©è™¹è¡¨æ”»æ“Š**ï¼š

* **Session ID**ï¼šæ¯æ¬¡é€£ç·šéš¨æ©Ÿç”Ÿæˆï¼Œç¢ºä¿æ¯æ¢é€£ç·šçš„ä¸Šä¸‹æ–‡ (Context) ç¨ä¸€ç„¡äºŒã€‚
* **Dynamic Salt**ï¼šçµåˆå…¬é‘°èˆ‡éš¨æ©Ÿæ•¸ç”Ÿæˆçš„é¹½å€¼ï¼Œç¢ºä¿å³ä½¿å…©æ¬¡æœƒè©±ä½¿ç”¨ç›¸åŒçš„é‡‘é‘° (æ©ŸçŽ‡æ¥µä½Ž)ï¼Œç”¢ç”Ÿçš„æœ€çµ‚ Session Key ä¹Ÿæœƒå®Œå…¨ä¸åŒã€‚

---

## ðŸš§ é™åˆ¶èˆ‡æœªä¾†å±•æœ›

### ç•¶å‰é™åˆ¶ (Limitations)

1. **æ¨¡æ“¬ PQC**ï¼šç›®å‰çš„ `encapsulate_pqc` èˆ‡ `decapsulate_pqc` ç‚ºé‚è¼¯æ¨¡æ“¬ (ä½¿ç”¨éš¨æ©Ÿæ•¸äº¤æ›)ã€‚åœ¨ç”Ÿç”¢ç’°å¢ƒä¸­ï¼Œéœ€æ›¿æ›ç‚º `liboqs-python` æˆ– `pyoqs` ä»¥åŸ·è¡ŒçœŸå¯¦çš„ Kyber æ•¸å­¸é‹ç®—ã€‚
2. **æ™‚é–“æ··æ·† (Bypass)**ï¼šç‚ºäº†ç¢ºä¿åˆ†æ•£å¼ç’°å¢ƒä¸‹çš„ç©©å®šæ€§ï¼Œç›®å‰çš„ã€Œæ™‚é–“æ··æ·†å±¤ã€è™•æ–¼ Pass-through æ¨¡å¼ã€‚æœªä¾†éœ€å¼•å…¥ NTP æ ¡æ™‚æ©Ÿåˆ¶æ‰èƒ½é–‹å•Ÿã€‚

### æœªä¾†è·¯ç·šåœ– (Roadmap)

* [ ] **æ•´åˆçœŸå¯¦ PQC åº«**ï¼šå¼•å…¥ `liboqs` å¯¦ä½œçœŸå¯¦ Kyber-768ã€‚
* [ ] **é›™å‘èªè­‰**ï¼šå¯¦ä½œæ•¸ä½ç°½ç«  (Dilithium æˆ– ECDSA) ä»¥é©—è­‰ Client/Server èº«åˆ†ã€‚
* [ ] **æŒä¹…åŒ–ç†µæ± **ï¼šå»ºç«‹å®‰å…¨çš„ç†µåŒæ­¥æ©Ÿåˆ¶ã€‚

---

> **Author**: [ä½ çš„åå­—]
> **Date**: 2025-12-28
> **Note**: æœ¬å°ˆæ¡ˆç‚ºè³‡å·¥ç³»ç³»çµ±è¨­è¨ˆèˆ‡å¯†ç¢¼å­¸å¯¦ä½œä¹‹åŽŸåž‹é©—è­‰ (PoC)ã€‚